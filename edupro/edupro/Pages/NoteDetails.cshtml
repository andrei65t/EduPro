@page
@model EduPro.Pages.NoteDetailsModel
@{
    ViewData["Title"] = Model.Note?.Title ?? "Detalii notiță";
    ViewData["PageTitle"] = Model.Note?.Title ?? "Notiță";
    ViewData["PageSubtitle"] = "Detalii complete";
}

@if (Model.Note == null)
{
    <div class="alert alert-danger">
        Notița nu a fost găsită.
    </div>
    <a asp-page="/NotesList" class="btn btn-primary">
        <i class="bi bi-arrow-left"></i> Înapoi la listă
    </a>
}
else
{
    <div class="row justify-content-center">
        <div class="col-xl-8">
            <div class="app-card">
                <div class="app-card-header">
                    <div>
                        <div class="app-card-title">
                            <i class="bi bi-file-text"></i>
                            @Model.Note.Title
                        </div>
                        <div class="app-card-subtitle">
                            <i class="bi bi-calendar"></i>
                            Creat: @Model.Note.CreatedAt.ToString("dd MMMM yyyy, HH:mm")
                        </div>
                    </div>
                    <div>
                        <a asp-page="/NotesList" class="btn btn-outline-light">
                            <i class="bi bi-arrow-left"></i> Înapoi
                        </a>
                    </div>
                </div>

                <div class="app-card-body p-4">
                    @if (!string.IsNullOrEmpty(Model.Note.Summary))
                    {
                        <div class="mb-4">
                            <h5>📋 Rezumat</h5>
                            <div class="mb-2 p-3 rounded border" style="background-color: #1e2530; color: #e4e7eb; border-color: #4cc9f0 !important;">
                                @Model.Note.Summary
                            </div>
                        </div>
                    }

                    <div class="mb-4">
                        <h5>📝 Text complet extras</h5>
                        <div class="mt-2 p-3 rounded border" style="background-color: #1e2530; color: #e4e7eb; border-color: #3d4756; white-space: pre-wrap; max-height: 400px; overflow-y: auto;">
                            @Model.Note.ExtractedText
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5>ℹ️ Informații fișier</h5>
                        <ul class="list-unstyled">
                            <li><strong>Nume original:</strong> @Model.Note.OriginalFileName</li>
                            <li><strong>Data creării:</strong> @Model.Note.CreatedAt.ToString("dd MMMM yyyy, HH:mm:ss")</li>
                            @if (Model.Note.UpdatedAt.HasValue)
                            {
                                <li><strong>Ultima modificare:</strong> @Model.Note.UpdatedAt.Value.ToString("dd MMMM yyyy, HH:mm:ss")</li>
                            }
                        </ul>
                    </div>

                    <div class="d-flex gap-2">
                        <a asp-page="/Explain" 
                           asp-route-text="@Model.Note.ExtractedText" 
                           class="btn btn-primary">
                            <i class="bi bi-lightbulb"></i> Explică acest text
                        </a>
                        <a asp-page="/AskNotes" 
                           asp-route-notes="@Model.Note.ExtractedText" 
                           class="btn btn-outline-primary">
                            <i class="bi bi-chat-dots"></i> Pune întrebări
                        </a>
                        <form method="post" asp-page-handler="Delete" class="d-inline" 
                              onsubmit="return confirm('Ești sigur că vrei să ștergi această notiță?');">
                            <input type="hidden" name="id" value="@Model.Note.Id" />
                            <button type="submit" class="btn btn-outline-danger">
                                <i class="bi bi-trash"></i> Șterge
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
